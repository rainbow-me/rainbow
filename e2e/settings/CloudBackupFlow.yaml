appId: ${APP_ID}
tags:
  - backup
  - parallel
---
- retry:
    maxRetries: 3
    commands:
      - launchApp:
          clearState: true
          clearKeychain: true
          arguments:
            isE2ETest: true
      - runFlow: ../utils/Prepare.yaml
      - runFlow: ../utils/ImportWalletWithKey.yaml

      # Navigate to settings and backup section
      - retry:
          maxRetries: 3
          commands:
            - tapOn:
                id: settings-menu
            - tapOn: 'Settings'
      - tapOn:
          id: backup-section
      - tapOn:
          id: backup-now-button
      # This part of the test is different for iOS and Android.
      - runFlow:
          when:
            platform: Android
          commands:
            - assertVisible: '(Sign in|Choose an account)'
            - tapOn: 'Email or phone'
            # On certain android versions this requires backing twice.
            # - retry:
            #     maxRetries: 2
            #     commands:
            # - back
            # - assertVisible: 'Wallets & Backup'
      # - runFlow:
      #     when:
      #       platform: iOS
      #     commands:
      #       - assertVisible: 'iCloud Not Enabled'
      #       - tapOn: 'No thanks'
      #       - assertVisible: 'Wallets & Backup'

      # - assertVisible: '.*Enable Cloud Backups'

      # # Check Learn More link
      # - tapOn: ".*Learn more.*"
